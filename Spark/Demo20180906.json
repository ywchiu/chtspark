{"paragraphs":[{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536203653405_485575185","id":"20180906-031413_549157612","dateCreated":"Sep 6, 2018 3:14:13 AM","status":"ABORT","progressUpdateIntervalMs":500,"$$hashKey":"object:2290","text":"%pyspark\n\na= [1,2,3,4,5,6,7,8]\n\nb = []\nfor ele in a:\n    if ele % 2 == 0 :\n        b.append(ele)\n\nc = sum(b)\nprint(c)\n","dateUpdated":"Sep 6, 2018 3:19:29 AM","dateFinished":"Sep 6, 2018 3:17:48 AM","dateStarted":"Sep 6, 2018 3:16:27 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"20\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","tableHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536203787502_399730732","id":"20180906-031627_152898470","dateCreated":"Sep 6, 2018 3:16:27 AM","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2311","dateUpdated":"Sep 6, 2018 3:24:15 AM","dateFinished":"Sep 6, 2018 3:22:36 AM","dateStarted":"Sep 6, 2018 3:22:36 AM","result":{"code":"ERROR","type":"TEXT","msg":"Traceback (most recent call last):\n  File \"/tmp/zeppelin_pyspark.py\", line 222, in <module>\n    eval(compiledCode)\n  File \"<string>\", line 1, in <module>\nImportError: No module named numpy\n"},"text":"%pyspark \n\nimport numpy\nna = numpy.array([1,2,3,4,5,6,7,8])\n\ndef f(ele):\n    return ele %2 ==0 \n    \nf(na)\n    "},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536204156268_-1871304108","id":"20180906-032236_315698331","dateCreated":"Sep 6, 2018 3:22:36 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2338","dateUpdated":"Sep 6, 2018 3:26:23 AM","dateFinished":"Sep 6, 2018 3:26:24 AM","dateStarted":"Sep 6, 2018 3:26:24 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[False, True, False, True, False, True, False, True]\n"},"text":"%pyspark\na = [1,2,3,4,5,6,7,8]\ndef f(ele):\n     return ele %2 ==0 \nna = [f(e) for e in a]\nprint(na)\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536204290515_-794240340","id":"20180906-032450_581217075","dateCreated":"Sep 6, 2018 3:24:50 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2376","dateUpdated":"Sep 6, 2018 5:41:58 AM","dateFinished":"Sep 6, 2018 5:41:12 AM","dateStarted":"Sep 6, 2018 5:41:12 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"ParallelCollectionRDD[2] at parallelize at PythonRDD.scala:423\n[1, 2, 3, 4, 5]\n"},"text":"%pyspark\n\n# python\ndata = [1,2,3,4,5]\n\n# Spark\nrdd  = sc.parallelize(data, 4)\nprint(rdd)\n\n# Spark => Python\nprint(rdd.collect())"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536212373843_1799978340","id":"20180906-053933_1073429055","dateCreated":"Sep 6, 2018 5:39:33 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2400","dateUpdated":"Sep 6, 2018 5:49:44 AM","dateFinished":"Sep 6, 2018 5:49:44 AM","dateStarted":"Sep 6, 2018 5:49:44 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'The Inaugural Address', u'', u'']\n"},"text":"%pyspark\nlines = sc.textFile(\"file:///tmp/trump.txt\")\nprint(lines.take(3))"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536212919766_-843265217","id":"20180906-054839_1614098110","dateCreated":"Sep 6, 2018 5:48:39 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2427","dateUpdated":"Sep 6, 2018 5:51:45 AM","dateFinished":"Sep 6, 2018 5:51:45 AM","dateStarted":"Sep 6, 2018 5:51:45 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"MapPartitionsRDD[15] at textFile at NativeMethodAccessorImpl.java:-2\n[u'The Inaugural Address', u'', u'']\n"},"text":"%pyspark\nlines = sc.textFile(\"hdfs:///trump.txt\")\nprint(lines)\nprint(lines.take(3))"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536213083645_1493008370","id":"20180906-055123_1135626000","dateCreated":"Sep 6, 2018 5:51:23 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2458","dateUpdated":"Sep 6, 2018 5:58:15 AM","dateFinished":"Sep 6, 2018 5:58:15 AM","dateStarted":"Sep 6, 2018 5:58:15 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"9\n9\n"},"text":"%pyspark \n\ndef square(e):\n    return e ** 2\n    \nprint(square(3))\n\n\nsquare2 = lambda e: e ** 2\nprint(square2(3))\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536213400121_-1416854663","id":"20180906-055640_1871141867","dateCreated":"Sep 6, 2018 5:56:40 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2481","dateUpdated":"Sep 6, 2018 6:04:59 AM","dateFinished":"Sep 6, 2018 6:05:00 AM","dateStarted":"Sep 6, 2018 6:04:59 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[2, 4, 6, 8]\n[2, 4, 6, 8]\n"},"text":"%pyspark\nrdd  = sc.parallelize([1,2,3,4])\nrdd2 = rdd.map(lambda e : e * 2)\nprint(rdd2.collect())\n\ndef timestwo(e):\n    return e * 2\n\nrdd3 = rdd.map(timestwo)\nprint(rdd3.collect())\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536213788039_1583231725","id":"20180906-060308_1984269995","dateCreated":"Sep 6, 2018 6:03:08 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2508","dateUpdated":"Sep 6, 2018 6:09:18 AM","dateFinished":"Sep 6, 2018 6:09:18 AM","dateStarted":"Sep 6, 2018 6:09:18 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[False, True, False, True]\n[2, 4]\n"},"text":"%pyspark\n\n\ndef filter_data(e):\n    return e % 2  == 0\n\n\nprint([filter_data(e) for e in [1,2,3,4]])\n\n\nrdd  = sc.parallelize([1,2,3,4])\nrdd2 = rdd.filter(lambda x : x % 2 == 0)\nprint(rdd2.collect())\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536214008943_-990648116","id":"20180906-060648_1307933078","dateCreated":"Sep 6, 2018 6:06:48 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2531","dateUpdated":"Sep 6, 2018 6:10:21 AM","dateFinished":"Sep 6, 2018 6:10:21 AM","dateStarted":"Sep 6, 2018 6:10:21 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[2, 4, 1, 3]\n"},"text":"%pyspark\nrdd  = sc.parallelize([1,4,2,2,3])\nrdd2 = rdd.distinct()\nprint(rdd2.collect())"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536214210156_-555634504","id":"20180906-061010_340490931","dateCreated":"Sep 6, 2018 6:10:10 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2554","dateUpdated":"Sep 6, 2018 6:13:07 AM","dateFinished":"Sep 6, 2018 6:13:07 AM","dateStarted":"Sep 6, 2018 6:13:07 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[[1, 6], [2, 7], [3, 8]]\n[1, 6, 2, 7, 3, 8]\n"},"text":"%pyspark \nrdd  = sc.parallelize([1,2,3])\nrdd2 = rdd.map(lambda x : [x, x+5])\nprint(rdd2.collect())\n\nrdd3 = rdd.flatMap(lambda x: [x,x+5])\nprint(rdd3.collect())"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536214309012_-468526366","id":"20180906-061149_1946244866","dateCreated":"Sep 6, 2018 6:11:49 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2578","dateUpdated":"Sep 6, 2018 6:21:51 AM","dateFinished":"Sep 6, 2018 6:21:52 AM","dateStarted":"Sep 6, 2018 6:21:51 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"6\n[1, 2]\n[1, 2, 3]\n"},"text":"%pyspark \nrdd  = sc.parallelize([1,2,3])\nprint(rdd.reduce(lambda a, b : a * b))\n\nprint(rdd.take(2))\n\n\nprint(rdd.collect())"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536214780832_825457517","id":"20180906-061940_788254238","dateCreated":"Sep 6, 2018 6:19:40 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2636","dateUpdated":"Sep 6, 2018 6:25:11 AM","dateFinished":"Sep 6, 2018 6:25:11 AM","dateStarted":"Sep 6, 2018 6:25:11 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[5, 3, 2]\n"},"text":"%pyspark \nrdd  = sc.parallelize([5,3,1,2])\nprint(rdd.takeOrdered(3, lambda s: -1 * s ))"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536215057940_-276464978","id":"20180906-062417_1906791287","dateCreated":"Sep 6, 2018 6:24:17 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2667","dateUpdated":"Sep 6, 2018 6:46:06 AM","dateFinished":"Sep 6, 2018 6:46:07 AM","dateStarted":"Sep 6, 2018 6:46:06 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[(1, 2), (3, 10)]\n"},"text":"%pyspark \nrdd  = sc.parallelize([(1,2),(3,4),(3,6)])\nrdd2 = rdd.reduceByKey(lambda a,b: a+ b)\nprint(rdd2.collect())"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536216339894_-431695573","id":"20180906-064539_446804452","dateCreated":"Sep 6, 2018 6:45:39 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2714","dateUpdated":"Sep 6, 2018 6:47:11 AM","dateFinished":"Sep 6, 2018 6:47:12 AM","dateStarted":"Sep 6, 2018 6:47:11 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[(1, 'a'), (1, 'b'), (2, 'c')]\n"},"text":"%pyspark \nrdd  = sc.parallelize([(1,'a'),(2,'c'),(1,'b')])\nrdd2 = rdd.sortByKey()\nprint(rdd2.collect())"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536216415804_595892118","id":"20180906-064655_1172652462","dateCreated":"Sep 6, 2018 6:46:55 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2739","dateUpdated":"Sep 6, 2018 6:47:59 AM","dateFinished":"Sep 6, 2018 6:47:59 AM","dateStarted":"Sep 6, 2018 6:47:59 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[(2, <pyspark.resultiterable.ResultIterable object at 0x1114c10>), (1, <pyspark.resultiterable.ResultIterable object at 0x1111210>)]\n"},"text":"%pyspark\nrdd  = sc.parallelize([(1,'a'),(2,'c'),(1,'b')])\nrdd2 = rdd.groupByKey()\nprint(rdd2.collect())"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536216454907_1255028281","id":"20180906-064734_1660432725","dateCreated":"Sep 6, 2018 6:47:34 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2762","dateUpdated":"Sep 6, 2018 6:51:34 AM","dateFinished":"Sep 6, 2018 6:51:35 AM","dateStarted":"Sep 6, 2018 6:51:34 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[1, 2, 3]\n"},"text":"%pyspark\nbroadcastVar = sc.broadcast([1,2,3])\nprint(broadcastVar.value)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536216688865_-155524128","id":"20180906-065128_258797859","dateCreated":"Sep 6, 2018 6:51:28 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2789","dateUpdated":"Sep 6, 2018 6:57:39 AM","dateFinished":"Sep 6, 2018 6:57:39 AM","dateStarted":"Sep 6, 2018 6:57:39 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"0\n"},"text":"%pyspark \n\naccum = sc.accumulator(0)\n\nrdd = sc.parallelize([1,2,3,4])\n\ndef f(x):\n    global accum\n    accum = accum + x\n    \nrdd.map(f)\nprint(accum.value)"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536216914232_-888380482","id":"20180906-065514_98990544","dateCreated":"Sep 6, 2018 6:55:14 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2808","dateUpdated":"Sep 6, 2018 7:11:43 AM","dateFinished":"Sep 6, 2018 7:11:44 AM","dateStarted":"Sep 6, 2018 7:11:44 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[(u'and', 72), (u'the', 71), (u'of', 49), (u'our', 48), (u'we', 45), (u'will', 40), (u'to', 37), (u'is', 21), (u'for', 17), (u'a', 15)]\n['hello', 'world']\n"},"text":"%pyspark\n\nrdd  = sc.textFile(\"file:///tmp/trump.txt\", 4)\n#res = rdd.take(5)\nrdd2 = rdd.flatMap(lambda e: e.lower().split())\nres  = rdd2.countByValue()\n\n\nimport operator\nswd = sorted(res.items(), key = operator.itemgetter(1), reverse=True)\nprint(swd[0:10])\n\na = 'hello world'\nprint(a.split())"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536217249973_1871329789","id":"20180906-070049_1882192844","dateCreated":"Sep 6, 2018 7:00:49 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2838","dateUpdated":"Sep 6, 2018 7:45:39 AM","dateFinished":"Sep 6, 2018 7:45:41 AM","dateStarted":"Sep 6, 2018 7:45:39 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[('Star Wars (1977)', 583), ('Contact (1997)', 509), ('Fargo (1996)', 508), ('Return of the Jedi (1983)', 507), ('Liar Liar (1997)', 485), ('English Patient, The (1996)', 481), ('Scream (1996)', 478), ('Toy Story (1995)', 452), ('Air Force One (1997)', 431), ('Independence Day (ID4) (1996)', 429)]\n"},"text":"%pyspark\nlines = sc.textFile(\"file:///tmp/u.data\")\n#print(lines.take(3))\n\nmovies = lines.map(lambda e : (int(e.split()[1]) , 1) )\n#print(movies.take(3))\n\nmovieCounts = movies.reduceByKey(lambda x,y:x+y)\n#print(movieCounts.take(3))\n\n\nres = movieCounts.sortBy(lambda a: -a[1])\n#print(res.take(3))\n\n\n\ndef loadMovieNames():\n    movieNames = {}\n    with open('/tmp/u.item') as f:\n        for line in f.readlines():\n            fields = line.strip().split('|')\n            movieNames[int(fields[0])] = fields[1]\n    return movieNames\n    \nm = loadMovieNames()\nnameDict = sc.broadcast(loadMovieNames())\nnameDict = sc.broadcast(m)\n\nres2 = res.map(lambda e: (nameDict.value.get(e[0]), e[1]) )\nprint(res2.take(10))"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536217944140_-74553360","id":"20180906-071224_2023530085","dateCreated":"Sep 6, 2018 7:12:24 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2892","dateUpdated":"Sep 6, 2018 8:14:03 AM","dateFinished":"Sep 6, 2018 8:14:16 AM","dateStarted":"Sep 6, 2018 8:14:03 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"[u'userid::itemid::rating', u'0::0::4', u'0::1::5']\nuserid::itemid::rating\n[u'0::0::4', u'0::1::5', u'0::7495::3']\n263777\n[[u'0', u'0', u'4'], [u'0', u'1', u'5'], [u'0', u'7495', u'3']]\n[Row(itemid=u'0', rating=4, userid=u'0'), Row(itemid=u'1', rating=5, userid=u'0'), Row(itemid=u'7495', rating=3, userid=u'0')]\n+------+------+------+\n|itemid|rating|userid|\n+------+------+------+\n|     0|     4|     0|\n|     1|     5|     0|\n|  7495|     3|     0|\n|  7496|     5|     0|\n|  7497|     5|     0|\n+------+------+------+\nonly showing top 5 rows\n\n+------+------+------+\n|itemid|rating|userid|\n+------+------+------+\n|     0|     4|     0|\n|     1|     5|     0|\n|  7495|     3|     0|\n|  7496|     5|     0|\n|  7497|     5|     0|\n+------+------+------+\nonly showing top 5 rows\n\n+------+------+\n|userid|rating|\n+------+------+\n|     0|     4|\n|     0|     5|\n|     0|     3|\n|     0|     5|\n|     0|     5|\n+------+------+\nonly showing top 5 rows\n\n+------+------+\n|userid|rating|\n+------+------+\n|     0|     5|\n|     0|     5|\n|     0|     5|\n|     0|     5|\n|     0|     5|\n+------+------+\nonly showing top 5 rows\n\n+------+------------------+\n|userid|       avg(rating)|\n+------+------------------+\n|   286| 3.741496598639456|\n|   330|3.4833333333333334|\n|   448|3.7277486910994764|\n|   781|            3.6125|\n|   899| 4.141414141414141|\n+------+------------------+\nonly showing top 5 rows\n\nroot\n |-- itemid: string (nullable = true)\n |-- rating: long (nullable = true)\n |-- userid: string (nullable = true)\n\nNone\n+------+---+\n|userid|_c1|\n+------+---+\n|  6048|5.0|\n|  6994|5.0|\n|  6381|5.0|\n+------+---+\n\n"},"text":"%pyspark \nfrom pyspark.sql import SQLContext\nsqlContext  = SQLContext(sc)\n\n\ndata_file = \"file:///tmp/ratings.txt\"\nraw_data  = sc.textFile(data_file)\nprint(raw_data.take(3))\n\nprint(raw_data.first())\n\n\nheader = raw_data.first()\nskip_data = raw_data.filter(lambda line: line != header)\nprint(skip_data.take(3))\nprint(skip_data.count())\n\ncsv_data = skip_data.map(lambda l: l.split('::'))\nprint(csv_data.take(3))\n\n\nfrom pyspark.sql import Row\n\nrow_data = csv_data.map(lambda p: Row(userid = p[0], itemid = p[1], rating = int(p[2]) ))\nprint(row_data.take(3))\n\n\ndf = sqlContext.createDataFrame(row_data)\ndf.registerTempTable(\"ratings\")\n\n\ndf.take(5)\n\ndf.show(5)\n\n# select * from df limit 5;\ndf.show(5)\n\n# select userid, rating from df limit 5;\ndf.select(\"userid\", \"rating\").show(5)\n\n# select userid, rating from df where rating >= 5 limit 5;\ndf.select(\"userid\", \"rating\").where(df.rating >= 5).show(5)\n\n# select userid, avg(rating) from df group by userid limit 5\ndf.select(\"userid\", \"rating\").groupBy(\"userid\").avg().show(5)\n\n\nprint(df.printSchema())\n\n\nrating_data = sqlContext.sql(\"select userid, avg(rating) from ratings group by userid order by avg(rating) desc limit 3\")\nrating_data.show()\n"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536220510820_-791691969","id":"20180906-075510_1430995044","dateCreated":"Sep 6, 2018 7:55:10 AM","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3018","dateUpdated":"Sep 6, 2018 8:24:35 AM","dateFinished":"Sep 6, 2018 8:24:52 AM","dateStarted":"Sep 6, 2018 8:24:35 AM","result":{"code":"SUCCESS","type":"TEXT","msg":"+--------------------+-----------+\n|            itemname|mean_rating|\n+--------------------+-----------+\n|IT Services & Com...|        5.0|\n|Real Estate Servi...|        5.0|\n|Vegan Middle East...|        5.0|\n+--------------------+-----------+\n\n"},"text":"%pyspark \nfrom pyspark.sql import SQLContext\nfrom pyspark.sql import Row\nsqlContext  = SQLContext(sc)\n\ndata_file = \"file:///tmp/ratings.txt\"\nraw_data  = sc.textFile(data_file)\nheader = raw_data.first()\nskip_data = raw_data.filter(lambda line: line != header)\ncsv_data = skip_data.map(lambda l: l.split('::'))\nrow_data = csv_data.map(lambda p: Row(userid = p[0], itemid = p[1], rating = int(p[2]) ))\ndf = sqlContext.createDataFrame(row_data)\ndf.registerTempTable(\"ratings\")\n\ndata_file = \"file:///tmp/items.txt\"\nraw_data  = sc.textFile(data_file)\ncsv_data = raw_data.map(lambda l: l.split('::'))\nrow_data = csv_data.map(lambda p: Row(itemid = p[0], itemname = p[1] ))\ndf2 = sqlContext.createDataFrame(row_data)\ndf2.registerTempTable(\"items\")\n\n\nrating_data = sqlContext.sql(\"select itemname, avg(rating) as mean_rating from ratings inner join items on ratings.itemid = items.itemid group by itemname order by avg(rating) desc limit 3\")\nrating_data.show()"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1536222212184_1675198674","id":"20180906-082332_2143290843","dateCreated":"Sep 6, 2018 8:23:32 AM","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3133"}],"name":"Demo20180906","id":"2DR4E6UV9","angularObjects":{"2DQS381XG":[],"2DP1NQB2Y":[],"2DS32RBA5":[],"2DPBHDJ9T":[],"2DPJ9SSE8":[],"2DSMNSEZQ":[],"2DP8EB2NX":[],"2DRSASV7F":[],"2DS7USPWU":[],"2DPCKDNAK":[],"2DS8ESHK4":[],"2DQWU4XT8":[],"2DS15K3WA":[]},"config":{"looknfeel":"default"},"info":{}}